<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Add Book – University Library</title>
  <link rel="stylesheet" href="style.css" />
</head>

<body>

  <!-- NAVBAR -->
  <nav class="navbar" id="navbar">
    <div class="logo">University Library</div>
    <div class="nav-links">
      <a href="admin_dashboard.html">Dashboard</a>
      <a href="books.html">Books</a>
      <a href="add_book.html" class="active">Add Book</a>
      <a href="index.html">Logout</a>
    </div>
  </nav>

  <!-- PAGE HEADER -->
  <section class="section" style="margin-top: 120px;">
    <h2 class="section-title">Add New Book</h2>

    <div class="add-form-container">
      <!-- مهم: enctype عشان رفع الصورة -->
      <form id="addBookForm" enctype="multipart/form-data">

        <label>Book Title</label>
        <input type="text" id="title" name="title" placeholder="Enter book title" required />

        <label>Author</label>
        <input type="text" id="author" name="author" placeholder="Enter author name" required />

        <label>ISBN</label>
<input
    type="text"
    name="isbn"
    placeholder="978-3-16-148410-0"
    required
>


        <label>Category</label>
        <select id="category" name="category" required style="width:100%; padding:12px; background:#1c130e; border:1px solid #e6c08b55; border-radius:10px; margin-top:6px; color:white;">
          <option value="" disabled selected>Choose category</option>
          <option value="Programming">Programming</option>
          <option value="Artificial Intelligence">Artificial Intelligence</option>
          <option value="History">History</option>
          <option value="Literature">Literature</option>
          <option value="Science">Science</option>
          <option value="Business">Business</option>
        </select>

        <label>Publication Year</label>
        <input type="number" id="year" name="year" placeholder="e.g. 2020" min="0" step="1" required />

        <label>Total Copies</label>
        <input type="number" id="totalCopies" name="total_copies" placeholder="e.g. 5" min="1" step="1" required />

        <label>Book Cover Image</label>
        <input type="file" id="imageInput" name="image" accept="image/*" />

        <button type="submit" class="btn-gold" id="submitBtn" style="margin-top: 20px;">Add Book</button>
      </form>

      <p id="successMsg" style="text-align:center; margin-top:20px; color:#e6c08b; font-size:18px;"></p>
    </div>
  </section>

  <footer class="footer">
    © 2025 University Library — Admin Panel
  </footer>

  <script>
    // NAVBAR EFFECT
    const navbar = document.getElementById("navbar");
    window.addEventListener("scroll", () => {
      if (window.scrollY > 80) navbar.classList.add("scrolled");
      else navbar.classList.remove("scrolled");
    });

    const form = document.getElementById("addBookForm");
    const successMsg = document.getElementById("successMsg");
    const submitBtn = document.getElementById("submitBtn");

    form.addEventListener("submit", async (e) => {
      e.preventDefault();

      successMsg.textContent = "";
      submitBtn.disabled = true;
      submitBtn.textContent = "Saving...";

      try {
        const fd = new FormData(form);

       
        // const res = await fetch("api/add_book.php", { method: "POST", body: fd });
        const res = await fetch("add_book.php", { method: "POST", body: fd });

        const data = await res.json();

        if (data.status === "success") {
          successMsg.textContent = "Book added successfully! ✔️";
          form.reset();
          setTimeout(() => {
            window.location.href = "books.html";
          }, 700);
        } else {
          alert(data.message || "Error adding book");
        }
      } catch (err) {
        alert("Server error / connection error");
      } finally {
        submitBtn.disabled = false;
        submitBtn.textContent = "Add Book";
      }
    });
  </script>

  <!-- app.js LocalStorage  -->
  <!-- <script src="app.js"></script> -->

</body>
</html>
